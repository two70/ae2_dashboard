<!DOCTYPE html>
<html>
  <head>
    <title>AE2 Dashboard</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <style>
      :root{--bg:#ffffff;--text:#0b1220;--muted:#556;--card:#fff;--accent:#3b82f6}
      .dark-mode{--bg:#0b1220;--text:#e6eef8;--muted:#9aa6b2;--card:#0f1720;--accent:#60a5fa}
      html,body{background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;margin:0;padding:0}
      .topbar{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid rgba(0,0,0,0.06)}
      .topbar .title{font-weight:600}
      .container{max-width:980px;margin:20px auto;padding:0 16px}
      button#dark-toggle{background:none;border:1px solid rgba(0,0,0,0.08);padding:6px 10px;border-radius:6px;cursor:pointer}
      .dark-mode button#dark-toggle{border-color:rgba(255,255,255,0.12)}
      table{width:100%;border-collapse:collapse;margin-top:8px;background:transparent}
      th,td{text-align:left;padding:10px 8px;border-bottom:1px solid rgba(0,0,0,0.06)}
      .dark-mode th,.dark-mode td{border-color:rgba(255,255,255,0.04)}
      thead th{background:transparent;font-weight:700}
      .table-wrap{overflow-x:auto}
      @media (max-width:600px){
        th:nth-child(2), td:nth-child(2){min-width:120px}
        th,td{padding:12px 10px}
      }
    </style>
    <script>
      (function(){
        function applyDark(isDark){
          if(isDark) document.documentElement.classList.add('dark-mode');
          else document.documentElement.classList.remove('dark-mode');
        }
        var stored = localStorage.getItem('ae2:dark');
        if(stored === null){
          var prefers = window.matchMedia && window.matchMedia('(prefers-color-scheme:dark)').matches;
          stored = prefers ? '1' : '0';
        }
        applyDark(stored === '1');
        window.toggleDark = function(){
          var on = document.documentElement.classList.toggle('dark-mode');
          localStorage.setItem('ae2:dark', on ? '1':'0');
        }
      })();
    </script>
  </head>

  <body>
    <div class="topbar">
      <div class="title">AE2 Dashboard</div>
      <div>
        <button id="dark-toggle" onclick="toggleDark()">Toggle Dark</button>
      </div>
    </div>
    <main class="container">
      <%= yield %>
    </main>
  </body>
</html>
